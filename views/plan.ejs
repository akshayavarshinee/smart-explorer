<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="/plan-style.css">
<link rel="stylesheet" href="/header-footer.css">
<title>Plan Your Vacation</title>
</head>
<body>

	<%- include("partials/header.ejs") %>

	<main>
		<form action="/generate-plan" method = "POST">
			<!-- Where will you be staying -->
			<h1>Plan Your Vacation</h1>
			<section class="card">
				<h2>Where will you be staying?</h2>
				<label for="hotel">Hotel or Address</label>
				<input type="text" id="hotel" placeholder="Enter hotel name or address" name = "place" required>
				<p class="hint">We'll find amazing places near your accommodation</p>
			</section>

			<!-- Trip Dates -->
			<section class="card">
				<h2>Trip Dates</h2>
				<div class="date-container">
					<div>
						<label for="checkin">Check-in Date</label>
						<input type="date" id="checkin" name = "checkin" required>
					</div>
					<div>
						<label for="checkout">Check-out Date</label>
						<input type="date" id="checkout" name = "checkout" required>
					</div>
				</div>
			</section>

			<!-- Search Radius -->
			<section class="card">
				<h2>Search Radius</h2>
				<input type="range" min="1" max="20" value="5" class="slider" name = "radius" required>
				<div class="range-labels">
					<span>1 km</span>
					<span>5 km</span>
					<span>20 km</span>
				</div>
				<p class="hint">How far are you willing to travel from your accommodation?</p>
			</section>

			<!-- Interests -->
			<section class="card">
				<h2>What interests you?</h2>
				<p class="hint">Select your preferences to get personalized recommendations</p>
				
				<div class="choose tags">
					<input type="text" class="interests" name="custom-interest" placeholder="Enter any other interests in your mind">
					<input type="hidden" name="selected-interests" id="selected-interests">
					<input type ="button" value ="Food & Dining">
					<input type ="button" value ="Nature & Parks">
					<input type ="button" value ="History & Culture">
					<input type ="button" value ="Museums">
					<input type ="button" value ="Shopping">
					<input type ="button" value ="Nightlife">
					<input type ="button" value ="Adventure Sports">
					<input type ="button" value ="Photography">
					<input type ="button" value ="Architecture">
					<input type ="button" value ="Local Markets">
					<input type ="button" value ="Art Galleries">
					<input type ="button" value ="Music & Entertainment">
				</div>
				<h5 id = "selected-display" style="visibility: hidden;">You have selected</h5>
				<div class = "selected tags" ></div>
			</section>

			<!-- Buttons -->
			<div class="buttons">
				<a href="/home"><button class="cancel">Cancel</button></a>
				<button type="submit" class="generate">Generate Plan</button></a>
			</div>
		</form>
	</main>

	<script>
		const chooseButtons = document.querySelectorAll(".choose input[type='button']");
		const selectedContainer = document.querySelector(".selected");
		const selectedDisplay = document.querySelector("#selected-display");
		const hiddenInput = document.getElementById("selected-interests");

		chooseButtons.forEach(btn => {
			btn.addEventListener("click", () => {
			selectedDisplay.style.visibility = "visible";

			// Prevent duplicates
			const exists = Array.from(selectedContainer.children)
								.some(c => c.textContent === btn.value);
			if (exists) return;

			const added = document.createElement("button");
			added.type = "button"; // so it won't submit
			added.textContent = btn.value;
			added.classList.add("tags");

			// Remove on click
			added.addEventListener("click", () => {
				selectedContainer.removeChild(added);

				// Hide title if empty
				if (selectedContainer.children.length === 0) {
				selectedDisplay.style.visibility = "hidden";
				}

				updateHiddenInput();
			});

			selectedContainer.appendChild(added);

			updateHiddenInput();
			});
		});

		function updateHiddenInput() {
			const values = Array.from(selectedContainer.children).map(c => c.textContent);
			hiddenInput.value = JSON.stringify(values);
		}
	</script>


	<%- include("partials/footer.ejs") %>
</body>
</html>